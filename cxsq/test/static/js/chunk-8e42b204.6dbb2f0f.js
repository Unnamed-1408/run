(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e42b204"],{2e3:function(e,a,t){},"9be4":function(e,a,t){"use strict";t("2000")},c686:function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("van-nav-bar",{attrs:{title:e.title}}),t("div",{staticClass:"userInfo mt46 pd20 bor-siz"},[t("div",{staticClass:"wp100"},[t("van-form",{on:{submit:e.onSubmit}},[t("van-cell",{staticClass:"mb10 bdr-p5 box-sad"},[t("div",{staticClass:"fb"},[e._v("身份信息")]),t("van-cell-group",{attrs:{inset:""}},[t("van-field",{attrs:{name:"account",label:"学号",placeholder:"学号",disabled:"",rules:[{required:!0,message:"请填写学号"}]},model:{value:e.fromDialog.account,callback:function(a){e.$set(e.fromDialog,"account",a)},expression:"fromDialog.account"}}),t("van-field",{attrs:{name:"name",label:"姓名",placeholder:"姓名",disabled:"",rules:[{required:!0,message:"请填写姓名"}]},model:{value:e.fromDialog.name,callback:function(a){e.$set(e.fromDialog,"name",a)},expression:"fromDialog.name"}}),t("van-field",{attrs:{name:"faultUserTelNodd",label:"院系/书院",placeholder:"院系/书院",disabled:"",rules:[{required:!0,message:"请填写院系/书院"}]},model:{value:e.fromDialog.faultUserTelNodd,callback:function(a){e.$set(e.fromDialog,"faultUserTelNodd",a)},expression:"fromDialog.faultUserTelNodd"}}),t("van-field",{attrs:{name:"tel",label:"手机号",placeholder:"手机号",type:"digit"},model:{value:e.fromDialog.tel,callback:function(a){e.$set(e.fromDialog,"tel",a)},expression:"fromDialog.tel"}})],1)],1),t("br"),t("van-cell",{staticClass:"mb10 bdr-p5 box-sad"},[t("div",{staticClass:"fb"},[e._v("申请信息")]),t("van-cell-group",{attrs:{inset:""}},[t("van-field",{attrs:{"is-link":"",readonly:"",name:"leaveStart",label:"出校时间",placeholder:"点击选择出校时间",rules:[{required:!0,message:"请填写出校时间"}]},on:{click:function(a){e.outSchoolShow=!0}},model:{value:e.fromDialog.leaveStart,callback:function(a){e.$set(e.fromDialog,"leaveStart",a)},expression:"fromDialog.leaveStart"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.outSchoolShow,callback:function(a){e.outSchoolShow=a},expression:"outSchoolShow"}},[t("van-datetime-picker",{attrs:{type:"datetime",title:"选择完整时间","min-date":e.minDate,"max-date":e.maxDate,"show-toolbar":""},on:{confirm:e.onConfirmOut,cancel:function(a){e.outSchoolShow=!1}},model:{value:e.currentDate,callback:function(a){e.currentDate=a},expression:"currentDate"}})],1),t("van-field",{attrs:{"is-link":"",readonly:"",name:"leaveEnd",label:"返校时间",placeholder:"点击选择返校时间",rules:[{required:!0,message:"请填写返校时间"}]},on:{click:function(a){e.retSchoolShow=!0}},model:{value:e.fromDialog.leaveEnd,callback:function(a){e.$set(e.fromDialog,"leaveEnd",a)},expression:"fromDialog.leaveEnd"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.retSchoolShow,callback:function(a){e.retSchoolShow=a},expression:"retSchoolShow"}},[t("van-datetime-picker",{attrs:{type:"datetime",title:"选择完整时间","min-date":e.minDate,"max-date":e.maxDate,"show-toolbar":""},on:{confirm:e.onConfirmRet,cancel:function(a){e.retSchoolShow=!1}},model:{value:e.currentDate,callback:function(a){e.currentDate=a},expression:"currentDate"}})],1),t("van-field",{attrs:{"is-link":"",readonly:"",name:"picker",label:"出校类型",placeholder:"选择出校类型",rules:[{required:!0,message:"请选择出校类型"}]},on:{click:function(a){e.showPicker=!0}},model:{value:e.fromDialog.gooutType,callback:function(a){e.$set(e.fromDialog,"gooutType",a)},expression:"fromDialog.gooutType"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(a){e.showPicker=a},expression:"showPicker"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{confirm:e.onConfirmStatus,cancel:function(a){e.showPicker=!1}}})],1),t("van-field",{attrs:{"is-link":"",readonly:"",name:"destination",label:"目的地",placeholder:"点击选择目的地",rules:[{required:!0,message:"请填写目的地"}]},on:{click:function(a){e.showArea=!0}},model:{value:e.fromDialog.destination,callback:function(a){e.$set(e.fromDialog,"destination",a)},expression:"fromDialog.destination"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.showArea,callback:function(a){e.showArea=a},expression:"showArea"}},[t("van-area",{attrs:{value:e.cityList,"area-list":e.areaList},on:{confirm:e.onConfirmCity,cancel:function(a){e.showArea=!1}}})],1),t("van-field",{attrs:{rows:"1",autosize:"",label:"详细地址",type:"textarea",name:"address",placeholder:"请输入详细地址",rules:[{required:!0,message:"详细地址"}]},model:{value:e.fromDialog.address,callback:function(a){e.$set(e.fromDialog,"address",a)},expression:"fromDialog.address"}}),t("van-field",{attrs:{name:"reason",label:"出校理由",placeholder:"出校理由",type:"textarea",rows:"1",autosize:"",rules:[{required:!0,message:"请填写出校理由"}]},model:{value:e.fromDialog.reason,callback:function(a){e.$set(e.fromDialog,"reason",a)},expression:"fromDialog.reason"}}),"pdf"!=e.promisePdf?t("van-field",{attrs:{name:"uploader",label:"离校承诺书"},scopedSlots:e._u([{key:"input",fn:function(){return["file"==e.resultTypeCNS?t("van-uploader",{attrs:{"result-type":"file","before-read":e.handleBeforeRead,"after-read":e.handleAfterRead,accept:e.accept,"max-count":e.numberInput,"before-delete":e.beforeDeleteCNS},model:{value:e.fromDialog.promiseBase64Url,callback:function(a){e.$set(e.fromDialog,"promiseBase64Url",a)},expression:"fromDialog.promiseBase64Url"}}):e._e(),"dataUrl"==e.resultTypeCNS?t("van-uploader",{attrs:{"result-type":"dataUrl","before-read":e.handleBeforeRead,"after-read":e.handleAfterRead,accept:e.accept,"max-count":e.numberInput,"before-delete":e.beforeDeleteCNS},model:{value:e.promiseUrl,callback:function(a){e.promiseUrl=a},expression:"promiseUrl"}}):e._e()]},proxy:!0}],null,!1,3789055228)}):e._e(),t("van-field",{directives:[{name:"show",rawName:"v-show",value:"pdf"==e.promisePdf,expression:"promisePdf == 'pdf'"}],attrs:{name:"uploader",label:"离校承诺书"},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-button",{attrs:{"native-type":"button",size:"small",type:"primary"},on:{click:function(a){return e.handlepromise(e.fromDialog.promiseUrl)}}},[e._v("查看离校承诺书")]),t("van-icon",{staticClass:"ml10",attrs:{size:"16",color:"#000",name:"close"},on:{click:e.handleClearCNS}})]},proxy:!0}])}),"pdf"!=e.filePdf?t("van-field",{attrs:{name:"uploader",label:"附件"},scopedSlots:e._u([{key:"input",fn:function(){return["file"==e.resultTypeFJ?t("van-uploader",{attrs:{"result-type":"file","before-read":e.handleBeforeRead2,"after-read":e.handleAfterReadFJ,accept:e.accept,"max-count":e.numberInput,"before-delete":e.beforeDeleteFJ},model:{value:e.fromDialog.fileBase64Url,callback:function(a){e.$set(e.fromDialog,"fileBase64Url",a)},expression:"fromDialog.fileBase64Url"}}):e._e(),"dataUrl"==e.resultTypeFJ?t("van-uploader",{attrs:{"result-type":"dataUrl","before-read":e.handleBeforeRead2,"after-read":e.handleAfterReadFJ,accept:e.accept,"max-count":e.numberInput,"before-delete":e.beforeDeleteFJ},model:{value:e.fileUrl,callback:function(a){e.fileUrl=a},expression:"fileUrl"}}):e._e()]},proxy:!0}],null,!1,2960633596)}):e._e(),t("van-field",{directives:[{name:"show",rawName:"v-show",value:"pdf"==e.filePdf,expression:"filePdf == 'pdf'"}],attrs:{name:"uploader",label:"附件"},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-button",{attrs:{"native-type":"button",size:"small",type:"primary"},on:{click:function(a){return e.handlefile(e.fromDialog.fileUrl)}}},[e._v("查看附件")]),t("van-icon",{staticClass:"ml10",attrs:{size:"16",color:"#000",name:"close"},on:{click:e.handleClearFJ}})]},proxy:!0}])})],1),t("span",{staticClass:"tisp"},[e._v("离校承诺书和附件只支持jpg\\png\\pdf格式文件")])],1),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"primary","native-type":"submit"}},[e._v("\n            提交\n          ")])],1)],1)],1)]),t("van-overlay",{attrs:{show:e.show}},[t("div",{staticClass:"wrapper"},[t("van-loading",{staticClass:"block",attrs:{size:"24px"}},[e._v(e._s(e.tisp)+"...")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.pdfZJShow,expression:"pdfZJShow"}],attrs:{id:"pdfZJ"}},[t("div",{staticClass:"close",on:{click:e.handleClose}},[e._v("关闭")]),t("div",{staticClass:"num1",on:{click:function(a){return e.handelPageSize("上一页")}}},[e._v("上一页")]),t("div",{staticClass:"num2",on:{click:function(a){return e.handelPageSize("下一页")}}},[e._v("下一页")]),t("pdf",{ref:"pdf",staticClass:"pdfDiv",attrs:{src:e.pdfurl,page:e.pageNumber}})],1)],1)},l=[],r=(t("a450"),t("5033")),i=t("81cb"),n=t("365c"),s=t("bde3"),c=t("b4dc"),d=t("89e3"),f={components:{"van-nav-bar":r["a"],pdf:c["a"]},data:function(){return{show:!1,showPicker:!1,id:"",outSchoolShow:!1,retSchoolShow:!1,showArea:!1,title:"出校申请",accept:"image/*,.pdf",numberInput:1,fromDialog:{},minDate:new Date(2020,0,1),maxDate:new Date(2025,10,1),currentDate:new Date,areaList:i["a"],cityList:"440305",promiseUrl:[],fileUrl:[],promisePdf:"",filePdf:"",columns:["离校-就医治疗","离校-实习工作","离校-参加考试","离校-学习交流","离校-其他事项","离校-规律性离校"],resultTypeCNS:"dataUrl",resultTypeFJ:"dataUrl",pdfurl:"",numPages:null,pdfZJShow:!1,pageNumber:1,tisp:"提交中"}},created:function(){this.id=this.$route.query.id,this.getData(this.$route.query.id)},mounted:function(){},methods:{getNumPages:function(e){var a=this;this.tisp="加载pdf",this.show=!0;var t=c["a"].createLoadingTask(e);t.promise.then((function(e){a.numPages=e.numPages,a.show=!1,a.pdfZJShow=!0})).catch((function(e){console.error("pdf 加载失败",e)}))},onSubmit:function(){var e=this;!this.fromDialog.promiseBase64||this.fromDialog.promiseBase64.length<=0?this.util.notify("danger","请上传离校承诺书"):(this.tisp="提交中",this.show=!0,Object(n["g"])(this.fromDialog).then((function(a){200==a.code?(e.show=!1,e.util.notify("success",a.msg),e.$router.push({path:"/"})):(e.show=!1,e.util.notify("danger",a.msg))})))},onConfirmOut:function(e){var a=Object(s["i"])(e);this.fromDialog.utSchool=a,this.outSchoolShow=!1},onConfirmRet:function(e){var a=Object(s["i"])(e);this.fromDialog.retSchool=a,this.retSchoolShow=!1},onConfirmCity:function(e){var a=e.map((function(e){return e.name})),t=a.join(",");this.fromDialog.address=t,this.showArea=!1},handleBeforeRead:function(e){return this.resultTypeCNS="application/pdf"==e.type?"file":"dataUrl","image/png"==e.type||"image/jpeg"==e.type||"application/pdf"==e.type||"image/jpg"==e.type||(this.util.notify("danger","请上传jpg/png/pdf格式文件"),!1)},handleBeforeRead2:function(e){return this.resultTypeFJ="application/pdf"==e.type?"file":"dataUrl","image/png"==e.type||"image/jpeg"==e.type||"application/pdf"==e.type||"image/jpg"==e.type||(this.util.notify("danger","请上传jpg/png/pdf格式文件"),!1)},getData:function(e){var a=this;Object(n["b"])(e).then((function(e){200==e.code&&(a.fromDialog=e.data,a.fromDialog.approveId=e.data.id,a.fromDialog.id="",a.promiseUrl=e.data.promiseUrl?[{url:e.data.promiseUrl}]:[],a.fromDialog.promiseBase64={},a.fileUrl=e.data.fileUrl?[{url:e.data.fileUrl}]:[],a.fromDialog.fileBase64={},a.fromDialog.faultUserTelNodd=e.data.studyAcademy+"/"+e.data.bookAcademy,a.fromDialog.destination=e.data.province+","+e.data.city+","+e.data.area,a.approveList=e.data.approveRecordList,a.promisePdf=e.data.promiseUrl?e.data.promiseUrl.substr(e.data.promiseUrl.lastIndexOf(".")+1,3):[],a.filePdf=e.data.fileUrl?e.data.fileUrl.substr(e.data.fileUrl.lastIndexOf(".")+1,3):[])}))},handlepromise:function(e){this.pdfurl=e,this.getNumPages(e)},handlefile:function(e){console.log(e),this.pdfurl=e,this.getNumPages(e)},handleClose:function(){this.pageNumber=1,this.pdfZJShow=!1},handelPageSize:function(e){if("上一页"==e){if(1==this.pageNumber)return void Object(d["a"])("已经是第一页");this.pageNumber=this.pageNumber-1}else{if(this.numPages==this.pageNumber)return void Object(d["a"])("已经最后一页");this.pageNumber=this.pageNumber+1}},handleAfterRead:function(e){"application/pdf"==e.file.type?this.resultTypeCNS="file":this.resultTypeCNS="dataUrl",this.fromDialog.promiseBase64={base64String:e.content,name:e.file.name,type:e.file.type}},handleAfterReadFJ:function(e){"application/pdf"==e.file.type?this.resultTypeFJ="file":this.resultTypeFJ="dataUrl",this.fromDialog.fileBase64={base64String:e.content,name:e.file.name,type:e.file.type}},onConfirmStatus:function(e){this.fromDialog.gooutType=e,this.showPicker=!1},handleClearCNS:function(){this.promisePdf="",this.promiseUrl=[],this.resultTypeCNS="dataUrl"},handleClearFJ:function(){this.filePdf="",this.fileUrl=[],this.resultTypeFJ="dataUrl"},beforeDeleteCNS:function(){return this.resultTypeCNS="dataUrl",!0},beforeDeleteFJ:function(){return this.resultTypeFJ="dataUrl",!0}}},u=f,p=(t("9be4"),t("cba8")),m=Object(p["a"])(u,o,l,!1,null,"126d6417",null);a["default"]=m.exports}}]);